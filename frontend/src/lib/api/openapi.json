{"openapi": "3.1.0", "info": {"title": "Knowledge Bank API", "description": "Modular RAG & Agentic Chatbot API", "version": "2.0.0"}, "paths": {"/": {"get": {"tags": ["health"], "summary": "Root", "operationId": "root__get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/chat/history/{thread_id}": {"get": {"tags": ["chat"], "summary": "Get Chat History", "operationId": "get_chat_history_chat_history__thread_id__get", "parameters": [{"name": "thread_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Thread Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/chat/threads": {"get": {"tags": ["chat"], "summary": "List Chat Threads", "operationId": "list_chat_threads_chat_threads_get", "parameters": [{"name": "workspace_id", "in": "query", "required": false, "schema": {"type": "string", "default": "default", "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/chat/threads/{thread_id}/title": {"patch": {"tags": ["chat"], "summary": "Update Thread Title", "operationId": "update_thread_title_chat_threads__thread_id__title_patch", "parameters": [{"name": "thread_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Thread Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/chat/threads/{thread_id}": {"delete": {"tags": ["chat"], "summary": "Delete Thread", "operationId": "delete_thread_chat_threads__thread_id__delete", "parameters": [{"name": "thread_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Thread Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/chat/stream": {"post": {"tags": ["chat"], "summary": "Chat Stream", "operationId": "chat_stream_chat_stream_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/upload": {"post": {"tags": ["documents"], "summary": "Upload Document", "operationId": "upload_document_upload_post", "parameters": [{"name": "workspace_id", "in": "query", "required": false, "schema": {"type": "string", "default": "default", "title": "Workspace Id"}}], "requestBody": {"required": true, "content": {"multipart/form-data": {"schema": {"$ref": "#/components/schemas/Body_upload_document_upload_post"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/documents": {"get": {"tags": ["documents"], "summary": "List Documents", "operationId": "list_documents_documents_get", "parameters": [{"name": "workspace_id", "in": "query", "required": false, "schema": {"type": "string", "default": "default", "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/documents-all": {"get": {"tags": ["documents"], "summary": "List All Documents", "operationId": "list_all_documents_documents_all_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/documents/{name}": {"get": {"tags": ["documents"], "summary": "Get Document", "operationId": "get_document_documents__name__get", "parameters": [{"name": "name", "in": "path", "required": true, "schema": {"type": "string", "title": "Name"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}, "delete": {"tags": ["documents"], "summary": "Delete Document", "operationId": "delete_document_documents__name__delete", "parameters": [{"name": "name", "in": "path", "required": true, "schema": {"type": "string", "title": "Name"}}, {"name": "workspace_id", "in": "query", "required": false, "schema": {"type": "string", "default": "default", "title": "Workspace Id"}}, {"name": "vault_delete", "in": "query", "required": false, "schema": {"type": "boolean", "default": false, "title": "Vault Delete"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/documents/{name}/chunks": {"get": {"tags": ["documents"], "summary": "Get Document Chunks", "operationId": "get_document_chunks_documents__name__chunks_get", "parameters": [{"name": "name", "in": "path", "required": true, "schema": {"type": "string", "title": "Name"}}, {"name": "limit", "in": "query", "required": false, "schema": {"type": "integer", "default": 100, "title": "Limit"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/documents/{name}/inspect": {"get": {"tags": ["documents"], "summary": "Inspect Document", "operationId": "inspect_document_documents__name__inspect_get", "parameters": [{"name": "name", "in": "path", "required": true, "schema": {"type": "string", "title": "Name"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/documents/update-workspaces": {"post": {"tags": ["documents"], "summary": "Update Document Workspaces", "operationId": "update_document_workspaces_documents_update_workspaces_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/workspaces": {"get": {"tags": ["workspaces"], "summary": "List Workspaces", "operationId": "list_workspaces_workspaces_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"items": {"$ref": "#/components/schemas/Workspace"}, "type": "array", "title": "Response List Workspaces Workspaces Get"}}}}}}, "post": {"tags": ["workspaces"], "summary": "Create Workspace", "operationId": "create_workspace_workspaces_post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/WorkspaceCreate"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/Workspace"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/workspaces/": {"get": {"tags": ["workspaces"], "summary": "List Workspaces", "operationId": "list_workspaces_workspaces__get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"items": {"$ref": "#/components/schemas/Workspace"}, "type": "array", "title": "Response List Workspaces Workspaces  Get"}}}}}}, "post": {"tags": ["workspaces"], "summary": "Create Workspace", "operationId": "create_workspace_workspaces__post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/WorkspaceCreate"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/Workspace"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/workspaces/{workspace_id}": {"patch": {"tags": ["workspaces"], "summary": "Update Workspace", "operationId": "update_workspace_workspaces__workspace_id__patch", "parameters": [{"name": "workspace_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Workspace Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"$ref": "#/components/schemas/WorkspaceUpdate"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/Workspace"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}, "delete": {"tags": ["workspaces"], "summary": "Delete Workspace", "operationId": "delete_workspace_workspaces__workspace_id__delete", "parameters": [{"name": "workspace_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Workspace Id"}}, {"name": "vault_delete", "in": "query", "required": false, "schema": {"type": "boolean", "default": false, "title": "Vault Delete"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/workspaces/{workspace_id}/details": {"get": {"tags": ["workspaces"], "summary": "Get Workspace Details", "operationId": "get_workspace_details_workspaces__workspace_id__details_get", "parameters": [{"name": "workspace_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/WorkspaceDetail"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/workspaces/{workspace_id}/share-document": {"post": {"tags": ["workspaces"], "summary": "Share Document", "operationId": "share_document_workspaces__workspace_id__share_document_post", "parameters": [{"name": "workspace_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/workspaces/{workspace_id}/graph": {"get": {"tags": ["workspaces"], "summary": "Get Workspace Graph", "operationId": "get_workspace_graph_workspaces__workspace_id__graph_get", "parameters": [{"name": "workspace_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/settings/": {"get": {"tags": ["settings"], "summary": "Get Settings", "description": "Get settings for a specific workspace or global defaults.", "operationId": "get_settings_settings__get", "parameters": [{"name": "workspace_id", "in": "query", "required": false, "schema": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Workspace Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/AppSettings"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}, "patch": {"tags": ["settings"], "summary": "Update Settings", "description": "Update settings for a specific workspace or global defaults.", "operationId": "update_settings_settings__patch", "parameters": [{"name": "workspace_id", "in": "query", "required": false, "schema": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Workspace Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "additionalProperties": true, "title": "Updates"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/AppSettings"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/tools/": {"get": {"tags": ["tools"], "summary": "List Tools", "description": "List all available tools and their status.", "operationId": "list_tools_tools__get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"items": {"$ref": "#/components/schemas/ToolDefinition"}, "type": "array", "title": "Response List Tools Tools  Get"}}}}}}, "post": {"tags": ["tools"], "summary": "Add Tool", "description": "Register a new tool (Custom/MCP).", "operationId": "add_tool_tools__post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/ToolDefinition"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/ToolDefinition"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/tools/{tool_id}/toggle": {"post": {"tags": ["tools"], "summary": "Toggle Tool", "description": "Enable or disable a tool.", "operationId": "toggle_tool_tools__tool_id__toggle_post", "parameters": [{"name": "tool_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Tool Id"}}, {"name": "enabled", "in": "query", "required": true, "schema": {"type": "boolean", "title": "Enabled"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/ToolDefinition"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/tools/{tool_id}": {"delete": {"tags": ["tools"], "summary": "Delete Tool", "description": "Delete a custom tool.", "operationId": "delete_tool_tools__tool_id__delete", "parameters": [{"name": "tool_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Tool Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/search/": {"get": {"tags": ["search"], "summary": "Global Search", "description": "Perform a unified search across all architectural entities.", "operationId": "global_search_search__get", "parameters": [{"name": "q", "in": "query", "required": true, "schema": {"type": "string", "minLength": 2, "description": "Search query", "title": "Q"}, "description": "Search query"}, {"name": "workspace_id", "in": "query", "required": false, "schema": {"anyOf": [{"type": "string"}, {"type": "null"}], "description": "Optional workspace scope", "title": "Workspace Id"}, "description": "Optional workspace scope"}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/tasks/": {"get": {"tags": ["tasks"], "summary": "List Tasks", "operationId": "list_tasks_tasks__get", "parameters": [{"name": "type", "in": "query", "required": false, "schema": {"type": "string", "title": "Type"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/tasks/{task_id}": {"get": {"tags": ["tasks"], "summary": "Get Task Status", "operationId": "get_task_status_tasks__task_id__get", "parameters": [{"name": "task_id", "in": "path", "required": true, "schema": {"type": "string", "title": "Task Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}}, "components": {"schemas": {"AppSettings": {"properties": {"llm_provider": {"type": "string", "enum": ["openai", "anthropic", "ollama", "vllm", "llama-cpp"], "title": "Llm Provider", "description": "LLM Provider", "default": "openai"}, "llm_model": {"type": "string", "title": "Llm Model", "description": "Model name", "default": "gpt-4o"}, "embedding_provider": {"type": "string", "enum": ["openai", "voyage", "local", "ollama", "vllm", "llama-cpp"], "title": "Embedding Provider", "description": "Embedding Provider", "default": "openai"}, "embedding_model": {"type": "string", "title": "Embedding Model", "description": "Embedding model name", "default": "text-embedding-3-small"}, "rag_engine": {"type": "string", "enum": ["basic", "graph"], "title": "Rag Engine", "description": "Selected workspace engine", "default": "basic"}, "retrieval_mode": {"type": "string", "enum": ["hybrid", "vector", "keyword"], "title": "Retrieval Mode", "description": "Search strategy", "default": "hybrid"}, "search_limit": {"type": "integer", "maximum": 20.0, "minimum": 1.0, "title": "Search Limit", "description": "Top-K results", "default": 5}, "hybrid_alpha": {"type": "number", "maximum": 1.0, "minimum": 0.0, "title": "Hybrid Alpha", "description": "Weight between vector and keyword", "default": 0.5}, "chunk_size": {"type": "integer", "maximum": 2000.0, "minimum": 100.0, "title": "Chunk Size", "default": 800}, "chunk_overlap": {"type": "integer", "maximum": 500.0, "minimum": 0.0, "title": "Chunk Overlap", "default": 150}, "embedding_dim": {"type": "integer", "title": "Embedding Dim", "description": "Fixed dimension for vector consistency", "default": 1536}, "neo4j_uri": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J Uri"}, "neo4j_user": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J User"}, "neo4j_password": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J Password"}, "theme": {"type": "string", "title": "Theme", "description": "App theme", "default": "dark"}, "show_reasoning": {"type": "boolean", "title": "Show Reasoning", "description": "Toggle reasoning steps visibility", "default": true}}, "type": "object", "title": "AppSettings"}, "Body_upload_document_upload_post": {"properties": {"file": {"type": "string", "format": "binary", "title": "File"}}, "type": "object", "required": ["file"], "title": "Body_upload_document_upload_post"}, "HTTPValidationError": {"properties": {"detail": {"items": {"$ref": "#/components/schemas/ValidationError"}, "type": "array", "title": "Detail"}}, "type": "object", "title": "HTTPValidationError"}, "ToolDefinition": {"properties": {"id": {"type": "string", "title": "Id"}, "name": {"type": "string", "title": "Name"}, "description": {"type": "string", "title": "Description"}, "type": {"type": "string", "title": "Type", "default": "system"}, "enabled": {"type": "boolean", "title": "Enabled", "default": true}, "config": {"anyOf": [{"additionalProperties": true, "type": "object"}, {"type": "null"}], "title": "Config", "default": {}}}, "type": "object", "required": ["id", "name", "description"], "title": "ToolDefinition"}, "ValidationError": {"properties": {"loc": {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}, "type": "array", "title": "Location"}, "msg": {"type": "string", "title": "Message"}, "type": {"type": "string", "title": "Error Type"}}, "type": "object", "required": ["loc", "msg", "type"], "title": "ValidationError"}, "Workspace": {"properties": {"id": {"type": "string", "title": "Id"}, "name": {"type": "string", "title": "Name"}, "description": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Description"}, "stats": {"anyOf": [{"$ref": "#/components/schemas/WorkspaceStats"}, {"type": "null"}]}}, "type": "object", "required": ["id", "name"], "title": "Workspace"}, "WorkspaceCreate": {"properties": {"name": {"type": "string", "title": "Name"}, "description": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Description"}, "rag_engine": {"type": "string", "enum": ["basic", "graph"], "title": "Rag Engine", "default": "basic"}, "embedding_provider": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Embedding Provider", "default": "openai"}, "embedding_model": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Embedding Model", "default": "text-embedding-3-small"}, "embedding_dim": {"anyOf": [{"type": "integer"}, {"type": "null"}], "title": "Embedding Dim", "default": 1536}, "chunk_size": {"anyOf": [{"type": "integer"}, {"type": "null"}], "title": "Chunk Size", "default": 800}, "chunk_overlap": {"anyOf": [{"type": "integer"}, {"type": "null"}], "title": "Chunk Overlap", "default": 150}, "neo4j_uri": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J Uri"}, "neo4j_user": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J User"}, "neo4j_password": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Neo4J Password"}}, "type": "object", "required": ["name"], "title": "WorkspaceCreate"}, "WorkspaceDetail": {"properties": {"id": {"type": "string", "title": "Id"}, "name": {"type": "string", "title": "Name"}, "description": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Description"}, "stats": {"anyOf": [{"$ref": "#/components/schemas/WorkspaceStats"}, {"type": "null"}]}, "threads": {"items": {"additionalProperties": true, "type": "object"}, "type": "array", "title": "Threads", "default": []}, "documents": {"items": {"additionalProperties": true, "type": "object"}, "type": "array", "title": "Documents", "default": []}, "settings": {"anyOf": [{"additionalProperties": true, "type": "object"}, {"type": "null"}], "title": "Settings"}}, "type": "object", "required": ["id", "name"], "title": "WorkspaceDetail"}, "WorkspaceStats": {"properties": {"thread_count": {"type": "integer", "title": "Thread Count", "default": 0}, "doc_count": {"type": "integer", "title": "Doc Count", "default": 0}}, "type": "object", "title": "WorkspaceStats"}, "WorkspaceUpdate": {"properties": {"name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name"}, "description": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Description"}}, "type": "object", "title": "WorkspaceUpdate"}}}}
